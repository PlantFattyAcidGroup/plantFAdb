<% content_for :top_bar do %>
	<h1 class="pagetitle">Publications</h1>
<% end %>

<% content_for :item_bar do %>
    <%#= link_to 'New Publication', new_publication_path, class: 'button'%>
    <%= link_to 'Download', params.merge(format: 'csv'), class: 'button'%>
    <%= form_tag publications_path, method: :get do %>
      <div style="float:right;padding-left:1em"><%= submit_tag "Go", class: "button"%></div>
      <div style="float:right">Search: <%= text_field_tag :query, params[:query] %></div>
    <% end %>
<% end %>
  <div class="pagination">
    <span style="float:left"><%= paginate @publications %></span>
    <span style="float:right;margin-right:2em"><%= page_entries_info @publications %></span>
  </div>

<div class='table'>
  <table class='listing'>
    <thead>
      <tr>
        <th style="width:15%"><%= sortable "plant.family", "Plant" %></th>
        <th style="width:5%"><%= sortable "year" %></th>
        <th style="width:15%"><%= sortable "authors" %></th>
        <th style="width:15%"><%= sortable "journal" %></th>
        <th style="width:5%"><%= sortable "volume" %></th>
        <th style="width:5%"><%= sortable "page" %></th>
        <th style="width:25%"><%= sortable "remarks" %></th>
        <th style="width:5%;white-space:nowrap"><%= sortable "result_count", "Data points" %></th>
        <th style="width:10%">Options</th>
      </tr>
    </thead>

    <tbody>
      <% @publications.each do |publication| %>
        <tr>
          <td><%= publication.plant.display_name %></td>
          <td><%= publication.year %></td>
          <td><%= publication.authors %></td>
          <td><%= publication.journal %></td>
          <td><%= publication.volume %></td>
          <td><%= publication.page %></td>
          <td><%= publication.remarks %></td>
          
          <td><%= link_to publication.results.count, results_path(publication_id: publication.id) %></td>
          <td style="white-space:nowrap">
            <%= link_to 'Show', publication %> |
            <%= link_to 'Edit', edit_publication_path(publication) %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>